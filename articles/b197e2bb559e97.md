---
title: "Tableau metadata apiã§ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®é–¢ä¿‚ã‚’æ´—ã„å‡ºã™"
emoji: "ğŸ“Š"
type: "tech"
topics:
  - "tableau"
published: true
published_at: "2025-02-19 22:17"
---

# ã¯ã˜ã‚ã«
Tableau metadata apiã¯çš†ã•ã‚“ä½¿ã£ã¦ã„ã¾ã™ã‹ï¼Ÿ
https://www.tableau.com/ja-jp/developer/tools/metadata-api

åƒ•ã¯ã¤ã‹ã£ã¦ã„ãªã‹ã£ãŸã‚“ã§ã™ãŒã€ä½œæˆã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã¨Tableauã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ä¾å­˜é–¢ä¿‚ãŒçŸ¥ã‚ŠãŸãã¦ä½¿ã£ã¦ã¿ã¾ã—ãŸã€‚

# å®Ÿéš›ã«ä½¿ã£ã¦ã¿ã‚‹
ã“ã“ã§ã¯ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã¤ã‹ã£ã¦èªè¨¼ã—ã¦ãŠã‚Šã¾ã™ã€‚
https://help.tableau.com/current/server/ja-jp/security_personal_access_tokens.htm
ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ã£ã¦èªè¨¼ã™ã‚‹ã¨è¿½åŠ ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚²ãƒƒãƒˆã§ãã‚‹ã®ã§ãã‚Œã‚’ã¤ã‹ã£ã¦ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

```python
import requests
server_url = 'https://xxxxx.com' # Tableauã®URL
token_name = 'Personal tokenã®ãªã¾ãˆ'
token_secret = 'Personal token'
site_id = 'Tableauã‚µã‚¤ãƒˆã®ID'

# Tableau serverã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦VERSIONéƒ¨åˆ†ãŒé•ã†ã‚ˆ
auth_url = f"{server_url}/api/{VERSION}/auth/signin"

auth_payload = {
    "credentials": {
        "personalAccessTokenName": token_name,
        "personalAccessTokenSecret": token_secret,
        "site": {
            "contentUrl": site_id
        }
    }
}

headers = {
    'Content-Type': 'application/json',
    'Accept': 'application/json'
}

response = requests.post(auth_url, json=auth_payload, headers=headers)
auth_response = response.json()
# Metadata APIã‚¢ã‚¯ã‚»ã‚¹ç”¨ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚²ãƒƒãƒˆã™ã‚‹
token = auth_response['credentials']['token']

# Metadata APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
metadata_url = f"{server_url}/api/metadata/graphql"

# GraphQLã‚¯ã‚¨ãƒª
query = """
{
  workbooks {
    name
    upstreamTables {
        name
        schema
      database {
        id
        name
      }
    }
    dashboards {
      name
      upstreamTables {
        name
      }
    }
  }
}
"""

# ãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¿½åŠ 
headers = {
    'Content-Type': 'application/json',
    'X-Tableau-Auth': token
}

# ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œ
response = requests.post(metadata_url, json={'query': query}, headers=headers)
metadata_response = response.json()
```

ä¸Šè¨˜ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã€Tableauã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æƒ…å ±ãŒã•ãã£ã¨å–å¾—ã§ãã¾ã™ã€‚ã‚ã¨ã¯è‡ªç”±ã«ã‚¯ã‚¨ãƒªãƒ¼ã‚’å¤‰æ›´ã—ã¦éŠã‚“ã§ã¿ã¦ãã ã•ã„ã€‚

Tableauã®graphiqlã¨ã„ã†ç”»é¢ã‹ã‚‰ã‚¯ã‚¨ãƒªãƒ¼ã‚’æŠ•ã’ã¦ç¢ºèªã§ãã‚‹ã®ã§ä¸€æ—¥éŠã¹ã¾ã™ã‚ˆï¼